window.tribe=window.tribe||{},tribe.events=tribe.events||{},tribe.events.views=tribe.events.views||{},tribe.events.virtualAdmin=tribe.events.virtualAdmin||{},tribe.events.virtualAdminAPI=tribe.events.virtualAdminAPI||{},function(e,t,n,i){const o=e(document);t.selectors={meetingContainer:".tec-events-virtual-meetings-api-container",meetingAccountDropdown:".tec-events-virtual-meetings-api__account-dropdown",meetingAccountSelect:".tec-events-virtual-meetings-api-action__account-select-link",meetingCreate:".tec-events-virtual-meetings-api-action__create-link",meetingCreateOptions:".tec-events-virtual-meetings-api-create__types",meetingCreateType:'input[name="tribe-events-virtual[%%APIID%%-meeting-type]"]:checked',meetingHostsDropdown:".tec-events-virtual-meetings-api__host-dropdown",meetingRemove:".tec-events-virtual-meetings-api-details__remove-link",meetingMessage:".tec-events-virtual-settings-message__wrap",meetingMessagesWrap:".tec-events-virtual-video-source-api-setup__messages-wrap",meetingDisplayLinkOption:"#tribe-events-virtual-meetings-api-display-details",googleMeetContainer:"#tribe-events-virtual-meetings-google",microsoftTeamsContainer:"#tribe-events-virtual-meetings-microsoft",webexMeetingContainer:"#tribe-events-virtual-meetings-webex",zoomMeetingContainer:"#tribe-events-virtual-meetings-zoom",virtualContainer:"#tribe-virtual-events",virtualEmbedVideoOption:"#tribe-events-virtual-embed-video",virtualHiddenElement:".tribe-events-virtual-hidden",virtualLinkedButtonOption:"#tribe-events-virtual-linked-button",virtualLoader:".tribe-common-c-loader",virtualLoaderHiddenElement:".tribe-common-a11y-hidden"},t.originalState={linkedButtonOption:{checked:e(t.selectors.virtualLinkedButtonOption).prop("checked")}},t.handleAccountSelection=function(n){n.preventDefault();const i=e(this).closest(t.selectors.meetingContainer),o=e(n.target).attr("href"),s=i.find(t.selectors.meetingAccountDropdown).find("option:selected").val();t.show(i),e.ajax(o,{contentType:"application/json",context:i,data:{account_id:s},success:t.onMeetingHandlingSuccess})},t.handleUserValidation=function(n){n.preventDefault();const i=e(this).closest(t.selectors.meetingContainer),o=e(t.selectors.meetingHostsDropdown).data("validateUrl"),s=e(t.selectors.meetingHostsDropdown).find("option:selected").val(),a=i.data("accountId");t.show(i),e.ajax(o,{contentType:"application/json",context:i,data:{account_id:a,host_id:s},success:t.onMeetingValidateUserSuccess})},t.onMeetingValidateUserSuccess=function(n){const i=e(this).closest(t.selectors.meetingContainer);t.hide(i);const o=e(n).filter(t.selectors.meetingMessage);i.find(t.selectors.meetingMessagesWrap).html(o);const s=e(n).filter(t.selectors.meetingCreateOptions);0!==s.length&&i.find(t.selectors.meetingCreateOptions).replaceWith(s)},t.handleCreateRequest=function(n){n.preventDefault();const i=e(this).closest(t.selectors.meetingContainer),s=i.data("apiId"),a=t.selectors.meetingCreateType.replace("%%APIID%%",s),r=e(a).data("type"),c=e(a).data("passwordRequirements"),l=i.find(a).val(),d=i.data("accountId");let u=i.find(t.selectors.meetingHostsDropdown).find("option:selected").val();u||(u=i.find(t.selectors.meetingHostsDropdown).data("hostId")),o.trigger("tec.virtual.api.create.validation",{apiId:s,meetingApiCreateType:a,accountId:d,hostId:u}),t.show(i),e.ajax(l,{contentType:"application/json",context:i,data:{host_id:u,account_id:d,password_requirements:c,meeting_type:r,EventStartDate:e("#EventStartDate").val(),EventStartTime:e("#EventStartTime").val(),EventEndDate:e("#EventEndDate").val(),EventEndTime:e("#EventEndTime").val(),EventTimezone:e("#event-timezone option:selected").val(),allDayCheckbox:!!e("#allDayCheckbox").prop("checked")||""},success:t.onMeetingHandlingSuccess})},t.handleRemoveRequest=function(n){if(n.preventDefault(),!confirm(e(this).data("confirmation")))return;const i=e(n.target).attr("href"),o=e(this).closest(t.selectors.meetingContainer);i&&t.removeRequestAjax(i,o)},t.removeRequestAjax=function(n,i){i&&t.show(i),e.ajax(n,{contentType:"application/json",context:i,success:t.onMeetingHandlingSuccess})},t.onMeetingHandlingSuccess=function(n){e(this).closest(t.selectors.meetingContainer).replaceWith(n),t.setupApiFields("")},t.handleAutoDetectGoogle=function(n,i){if(!i.html)return;const s=o.find(t.selectors.googleMeetContainer),a=e(i.html).filter(t.selectors.googleMeetContainer);0!==a.length&&(s.html(a),t.setupApiFields("google"))},t.handleAutoDetectMicrosoft=function(n,i){if(!i.html)return;const s=o.find(t.selectors.microsoftTeamsContainer),a=e(i.html).filter(t.selectors.microsoftTeamsContainer);0!==a.length&&(s.html(a),t.setupApiFields("microsoft"))},t.handleAutoDetectWebex=function(n,i){if(!i.html)return;const s=o.find(t.selectors.webexMeetingContainer),a=e(i.html).filter(t.selectors.webexMeetingContainer);0!==a.length&&(s.html(a),t.setupApiFields("webex"))},t.handleAutoDetectZoom=function(n,i){if(!i.html)return;const s=o.find(t.selectors.zoomMeetingContainer),a=e(i.html).filter(t.selectors.zoomMeetingContainer);0!==a.length&&(s.html(a),t.setupApiFields("zoom"))},t.setupApiFields=function(i){i?e(n.selectors.videoSource).val(i).trigger("change").trigger("verify.dependency"):e(n.selectors.videoSource).trigger("verify.dependency"),t.setupControls(),t.checkButtons(),t.initTribeDropdowns(),n.handleShowOptionInteractivity&&"function"==typeof n.handleShowOptionInteractivity&&n.handleShowOptionInteractivity()},t.handleLinkedMetaRemove=function(){const n=e(t.selectors.meetingRemove).attr("href");n&&t.removeRequestAjax(n)},t.checkButtons=function(){const n=e(t.selectors.meetingDisplayLinkOption);e(t.selectors.virtualLinkedButtonOption).prop("checked",!0),n.prop("checked",!0)},t.setupControls=function(){const i=e(t.selectors.virtualEmbedVideoOption).closest("li"),o=e(t.selectors.meetingDisplayLinkOption).closest("li"),s=e(t.selectors.virtualLinkedButtonOption),a=e(n.selectors.videoSource).val();"webex"===a||"zoom"===a?(i.addClass(t.selectors.virtualHiddenElement.className()),o.removeClass(t.selectors.virtualHiddenElement.className())):(i.removeClass(t.selectors.virtualHiddenElement.className()),o.addClass(t.selectors.virtualHiddenElement.className()),s.prop("checked",t.originalState.linkedButtonOption.checked))},t.initTribeDropdowns=function(){e(document).find(t.selectors.meetingContainer).find(i.selector.dropdown).not(i.selector.created).tribe_dropdowns()},t.show=function(e){const n=e.find(t.selectors.virtualLoader);n.length&&n.removeClass(t.selectors.virtualLoaderHiddenElement.className())},t.hide=function(e){const n=e.find(t.selectors.virtualLoader);n.length&&n.addClass(t.selectors.virtualLoaderHiddenElement.className())},t.bindEvents=function(){e(t.selectors.virtualContainer).on("click",t.selectors.meetingAccountSelect,t.handleAccountSelection).on("click",t.selectors.meetingCreate,t.handleCreateRequest).on("click",t.selectors.meetingRemove,t.handleRemoveRequest),o.on("virtual.delete",t.handleLinkedMetaRemove),o.on("change",t.selectors.meetingHostsDropdown,t.handleUserValidation),o.on("autodetect.complete",t.handleAutoDetectGoogle).on("autodetect.complete",t.handleAutoDetectMicrosoft).on("autodetect.complete",t.handleAutoDetectWebex).on("autodetect.complete",t.handleAutoDetectZoom)},t.ready=function(){t.bindEvents()},e(t.ready)}(jQuery,tribe.events.virtualAdminAPI,tribe.events.virtualAdmin,tribe_dropdowns);
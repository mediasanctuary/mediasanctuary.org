tribe.events=tribe.events||{},tribe.events.virtualAdmin=tribe.events.virtualAdmin||{},function(e,t){var o=e(document);t.selectors={configure:".tribe-configure-virtual-button",displayOption:".tribe-events-virtual-display",displayOptionCheckbox:'.tribe-events-virtual-display input[type="checkbox"]',embedCheckbox:"#tribe-events-virtual-embed-video",embedNotice:".tribe-events-virtual-video-source__not-embeddable-notice",embedNoticeShow:".tribe-events-virtual-video-source__not-embeddable-notice--show",embedNoticeText:".tribe-events-virtual-video-source__not-embeddable-text",remove:".tribe-remove-virtual-event",setupCheckbox:"#tribe-events-virtual-setup",showOptions:".tribe-events-virtual-show input",showAll:"#tribe-events-virtual-show-to-all",videoSource:"#tribe-events-virtual-video-source",videoSourcesWrap:".tribe-events-virtual-video-sources-wrap",videoSourceDetails:".tribe-events-virtual-video-sources",videoSourcesFloat:".tribe-events-virtual-video-sources--float",virtualContainer:"#tribe-virtual-events",virtualUrl:".tribe-events-virtual-video-source__virtual-url-input"},t.setCheckboxCheckedAttr=function(r){return t.isGutenbergActive()?function(){const i=wp.data.select("core/block-editor").getBlocks(),s=i.find(e=>"tribe/event-price"===e.name);if(r){if(i.filter(e=>"tribe/virtual-event"===e.name).length)return void e(t.selectors.setupCheckbox).prop("checked",r).trigger("verify.dependency");if(s){const e=wp.data.select("core/block-editor").getBlockIndex(s.clientId),t=wp.blocks.createBlock("tribe/virtual-event");wp.data.dispatch("core/block-editor").insertBlock(t,e+1,"",!1)}else{const e=wp.blocks.createBlock("tribe/virtual-event");wp.data.dispatch("core/block-editor").insertBlock(e)}o.trigger("virtual.add"),document.getElementById("tribe-virtual-events").scrollIntoView()}else{if(!confirm(tribe_events_virtual_strings.deleteConfirm))return;tribe.events.metaboxDelete=!0,i.forEach(e=>{"tribe/virtual-event"===e.name&&wp.data.dispatch("core/block-editor").removeBlock(e.clientId)}),o.trigger("virtual.delete"),tribe.events.metaboxDelete=!1}e(t.selectors.setupCheckbox).prop("checked",r).trigger("verify.dependency")}:function(){if(r)o.trigger("virtual.add");else{if(!confirm(tribe_events_virtual_strings.deleteConfirm))return;o.trigger("virtual.delete")}e(t.selectors.setupCheckbox).prop("checked",r).trigger("verify.dependency")}},t.testEmbed=function(){if("video"!==e(t.selectors.videoSource).val())return;const o=e(t.selectors.virtualUrl),r=o.val(),i=o.attr("data-nonce");o.attr("data-oembed-test")&&r&&i?e.ajax({type:"post",dataType:"json",url:ajaxurl,data:{action:"tribe_events_virtual_check_oembed",url:r,nonce:i}}).done(function(){t.hideOembedNotice()}).fail(function(e){t.showOembedNotice(e)}):t.hideOembedNotice()},t.hideOembedNotice=function(){e(t.selectors.embedNotice).removeClass(t.selectors.embedNoticeShow.className()),e(t.selectors.embedCheckbox).prop({disabled:!1})},t.showOembedNotice=function(o){e(t.selectors.embedNoticeText).html(o.responseJSON.data),e(t.selectors.embedNotice).addClass(t.selectors.embedNoticeShow.className()),e(t.selectors.embedCheckbox).prop({disabled:!0,checked:!1})},t.handleShowOptionEnablement=function(){var o=e(t.selectors.displayOption).find(":checked:visible").length,r=e(t.selectors.showOptions);o>0?r.prop({disabled:!1}):r.prop({disabled:!0})},t.handleShowOptionInteractivity=function(o){if(o&&Object.prototype.hasOwnProperty.call(o,"target")){var r=e(o.target);r.prop("checked")&&"all"!==r.val()&&e(t.selectors.showAll).prop("checked",!1)}},t.bindEvents=function(){e(t.selectors.virtualContainer).on("click",t.selectors.configure,t.setCheckboxCheckedAttr(!0)).on("click",t.selectors.remove,t.setCheckboxCheckedAttr(!1)).on("blur",t.selectors.virtualUrl,t.testEmbed).on("click",t.selectors.displayOptionCheckbox,t.handleShowOptionEnablement).on("change",t.selectors.showOptions,t.handleShowOptionInteractivity)},t.isGutenbergActive=function(){return"undefined"!=typeof wp&&void 0!==wp.blocks&&void 0!==wp.data&&!!wp.data.select("core/blocks").getBlockType("tribe/virtual-event")},t.ready=function(){t.bindEvents(),t.testEmbed(),setTimeout(function(){e(t.selectors.videoSource).trigger("verify.dependency")},0)},t.handleVideoSourceClasses=function(){console.info("Method deprecated with no replacement.");var o=e(t.selectors.videoSourceDetails);if(o.length){var r=e(t.selectors.videoSourcesWrap);r.parent().width()>=o.outerWidth(!0)+r.outerWidth(!0)?o.addClass(t.selectors.videoSourcesFloat.className()):o.removeClass(t.selectors.videoSourcesFloat.className())}},e(t.ready)}(jQuery,tribe.events.virtualAdmin);